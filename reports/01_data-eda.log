Traceback (most recent call last):
  File "/home/simonjisu/miniconda3/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/home/simonjisu/miniconda3/lib/python3.8/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/simonjisu/miniconda3/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/simonjisu/miniconda3/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/home/simonjisu/miniconda3/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/home/simonjisu/miniconda3/lib/python3.8/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/simonjisu/miniconda3/lib/python3.8/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/simonjisu/miniconda3/lib/python3.8/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# see if the missing values are more than 1day
df_group = df.groupby([df.index.get_level_values(0)] + [pd.Grouper(freq='1D', level=-1)]).apply(lambda x: x.isnull().sum() == 24)
# example
df.loc[(df.index.get_level_values(0) == 111121) & 
    (df.index.get_level_values(1) <='2020-05-24 23:00:00') & 
    (df.index.get_level_values(1) > '2020-05-22 23:00:00') ]
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Input [0;32mIn [7][0m, in [0;36m<cell line: 2>[0;34m()[0m
[1;32m      1[0m [38;5;66;03m# see if the missing values are more than 1day[39;00m
[0;32m----> 2[0m df_group [38;5;241m=[39m [43mdf[49m[38;5;241;43m.[39;49m[43mgroupby[49m[43m([49m[43m[[49m[43mdf[49m[38;5;241;43m.[39;49m[43mindex[49m[38;5;241;43m.[39;49m[43mget_level_values[49m[43m([49m[38;5;241;43m0[39;49m[43m)[49m[43m][49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[43m[[49m[43mpd[49m[38;5;241;43m.[39;49m[43mGrouper[49m[43m([49m[43mfreq[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43m1D[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mlevel[49m[38;5;241;43m=[39;49m[38;5;241;43m-[39;49m[38;5;241;43m1[39;49m[43m)[49m[43m][49m[43m)[49m[38;5;241m.[39mapply([38;5;28;01mlambda[39;00m x: x[38;5;241m.[39misnull()[38;5;241m.[39msum() [38;5;241m==[39m [38;5;241m24[39m)
[1;32m      3[0m [38;5;66;03m# example[39;00m
[1;32m      4[0m df[38;5;241m.[39mloc[(df[38;5;241m.[39mindex[38;5;241m.[39mget_level_values([38;5;241m0[39m) [38;5;241m==[39m [38;5;241m111121[39m) [38;5;241m&[39m 
[1;32m      5[0m     (df[38;5;241m.[39mindex[38;5;241m.[39mget_level_values([38;5;241m1[39m) [38;5;241m<[39m[38;5;241m=[39m[38;5;124m'[39m[38;5;124m2020-05-24 23:00:00[39m[38;5;124m'[39m) [38;5;241m&[39m 
[1;32m      6[0m     (df[38;5;241m.[39mindex[38;5;241m.[39mget_level_values([38;5;241m1[39m) [38;5;241m>[39m [38;5;124m'[39m[38;5;124m2020-05-22 23:00:00[39m[38;5;124m'[39m) ]

File [0;32m~/miniconda3/lib/python3.8/site-packages/pandas/core/frame.py:7706[0m, in [0;36mDataFrame.groupby[0;34m(self, by, axis, level, as_index, sort, group_keys, squeeze, observed, dropna)[0m
[1;32m   7701[0m axis [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_axis_number(axis)
[1;32m   7703[0m [38;5;66;03m# https://github.com/python/mypy/issues/7642[39;00m
[1;32m   7704[0m [38;5;66;03m# error: Argument "squeeze" to "DataFrameGroupBy" has incompatible type[39;00m
[1;32m   7705[0m [38;5;66;03m# "Union[bool, NoDefault]"; expected "bool"[39;00m
[0;32m-> 7706[0m [38;5;28;01mreturn[39;00m [43mDataFrameGroupBy[49m[43m([49m
[1;32m   7707[0m [43m    [49m[43mobj[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[43m,[49m
[1;32m   7708[0m [43m    [49m[43mkeys[49m[38;5;241;43m=[39;49m[43mby[49m[43m,[49m
[1;32m   7709[0m [43m    [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m   7710[0m [43m    [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m   7711[0m [43m    [49m[43mas_index[49m[38;5;241;43m=[39;49m[43mas_index[49m[43m,[49m
[1;32m   7712[0m [43m    [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m   7713[0m [43m    [49m[43mgroup_keys[49m[38;5;241;43m=[39;49m[43mgroup_keys[49m[43m,[49m
[1;32m   7714[0m [43m    [49m[43msqueeze[49m[38;5;241;43m=[39;49m[43msqueeze[49m[43m,[49m[43m  [49m[38;5;66;43;03m# type: ignore[arg-type][39;49;00m
[1;32m   7715[0m [43m    [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[1;32m   7716[0m [43m    [49m[43mdropna[49m[38;5;241;43m=[39;49m[43mdropna[49m[43m,[49m
[1;32m   7717[0m [43m[49m[43m)[49m

File [0;32m~/miniconda3/lib/python3.8/site-packages/pandas/core/groupby/groupby.py:882[0m, in [0;36mGroupBy.__init__[0;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, squeeze, observed, mutated, dropna)[0m
[1;32m    879[0m [38;5;28;01mif[39;00m grouper [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    880[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mpandas[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcore[39;00m[38;5;21;01m.[39;00m[38;5;21;01mgroupby[39;00m[38;5;21;01m.[39;00m[38;5;21;01mgrouper[39;00m [38;5;28;01mimport[39;00m get_grouper
[0;32m--> 882[0m     grouper, exclusions, obj [38;5;241m=[39m [43mget_grouper[49m[43m([49m
[1;32m    883[0m [43m        [49m[43mobj[49m[43m,[49m
[1;32m    884[0m [43m        [49m[43mkeys[49m[43m,[49m
[1;32m    885[0m [43m        [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m    886[0m [43m        [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m    887[0m [43m        [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m    888[0m [43m        [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[1;32m    889[0m [43m        [49m[43mmutated[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmutated[49m[43m,[49m
[1;32m    890[0m [43m        [49m[43mdropna[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdropna[49m[43m,[49m
[1;32m    891[0m [43m    [49m[43m)[49m
[1;32m    893[0m [38;5;28mself[39m[38;5;241m.[39mobj [38;5;241m=[39m obj
[1;32m    894[0m [38;5;28mself[39m[38;5;241m.[39maxis [38;5;241m=[39m obj[38;5;241m.[39m_get_axis_number(axis)

File [0;32m~/miniconda3/lib/python3.8/site-packages/pandas/core/groupby/grouper.py:893[0m, in [0;36mget_grouper[0;34m(obj, key, axis, level, sort, observed, mutated, validate, dropna)[0m
[1;32m    888[0m         in_axis [38;5;241m=[39m [38;5;28;01mFalse[39;00m
[1;32m    890[0m     [38;5;66;03m# create the Grouping[39;00m
[1;32m    891[0m     [38;5;66;03m# allow us to passing the actual Grouping as the gpr[39;00m
[1;32m    892[0m     ping [38;5;241m=[39m (
[0;32m--> 893[0m         [43mGrouping[49m[43m([49m
[1;32m    894[0m [43m            [49m[43mgroup_axis[49m[43m,[49m
[1;32m    895[0m [43m            [49m[43mgpr[49m[43m,[49m
[1;32m    896[0m [43m            [49m[43mobj[49m[38;5;241;43m=[39;49m[43mobj[49m[43m,[49m
[1;32m    897[0m [43m            [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m    898[0m [43m            [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m    899[0m [43m            [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[1;32m    900[0m [43m            [49m[43min_axis[49m[38;5;241;43m=[39;49m[43min_axis[49m[43m,[49m
[1;32m    901[0m [43m            [49m[43mdropna[49m[38;5;241;43m=[39;49m[43mdropna[49m[43m,[49m
[1;32m    902[0m [43m        [49m[43m)[49m
[1;32m    903[0m         [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(gpr, Grouping)
[1;32m    904[0m         [38;5;28;01melse[39;00m gpr
[1;32m    905[0m     )
[1;32m    907[0m     groupings[38;5;241m.[39mappend(ping)
[1;32m    909[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(groupings) [38;5;241m==[39m [38;5;241m0[39m [38;5;129;01mand[39;00m [38;5;28mlen[39m(obj):

File [0;32m~/miniconda3/lib/python3.8/site-packages/pandas/core/groupby/grouper.py:515[0m, in [0;36mGrouping.__init__[0;34m(self, index, grouper, obj, level, sort, observed, in_axis, dropna)[0m
[1;32m    509[0m [38;5;28;01melif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m[38;5;241m.[39mgrouping_vector, Grouper):
[1;32m    510[0m     [38;5;66;03m# get the new grouper; we already have disambiguated[39;00m
[1;32m    511[0m     [38;5;66;03m# what key/level refer to exactly, don't need to[39;00m
[1;32m    512[0m     [38;5;66;03m# check again as we have by this point converted these[39;00m
[1;32m    513[0m     [38;5;66;03m# to an actual value (rather than a pd.Grouper)[39;00m
[1;32m    514[0m     [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mobj [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m  [38;5;66;03m# for mypy[39;00m
[0;32m--> 515[0m     _, newgrouper, newobj [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgrouping_vector[49m[38;5;241;43m.[39;49m[43m_get_grouper[49m[43m([49m
[1;32m    516[0m [43m        [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mobj[49m[43m,[49m[43m [49m[43mvalidate[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m
[1;32m    517[0m [43m    [49m[43m)[49m
[1;32m    518[0m     [38;5;28mself[39m[38;5;241m.[39mobj [38;5;241m=[39m newobj
[1;32m    520[0m     ng [38;5;241m=[39m newgrouper[38;5;241m.[39m_get_grouper()

File [0;32m~/miniconda3/lib/python3.8/site-packages/pandas/core/resample.py:1607[0m, in [0;36mTimeGrouper._get_grouper[0;34m(self, obj, validate)[0m
[1;32m   1605[0m [38;5;28;01mdef[39;00m [38;5;21m_get_grouper[39m([38;5;28mself[39m, obj, validate: [38;5;28mbool[39m [38;5;241m=[39m [38;5;28;01mTrue[39;00m):
[1;32m   1606[0m     [38;5;66;03m# create the resampler and return our binner[39;00m
[0;32m-> 1607[0m     r [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_get_resampler[49m[43m([49m[43mobj[49m[43m)[49m
[1;32m   1608[0m     [38;5;28;01mreturn[39;00m r[38;5;241m.[39mbinner, r[38;5;241m.[39mgrouper, r[38;5;241m.[39mobj

File [0;32m~/miniconda3/lib/python3.8/site-packages/pandas/core/resample.py:1589[0m, in [0;36mTimeGrouper._get_resampler[0;34m(self, obj, kind)[0m
[1;32m   1570[0m [38;5;28;01mdef[39;00m [38;5;21m_get_resampler[39m([38;5;28mself[39m, obj, kind[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[1;32m   1571[0m     [38;5;124;03m"""[39;00m
[1;32m   1572[0m [38;5;124;03m    Return my resampler or raise if we have an invalid axis.[39;00m
[1;32m   1573[0m 
[0;32m   (...)[0m
[1;32m   1587[0m 
[1;32m   1588[0m [38;5;124;03m    """[39;00m
[0;32m-> 1589[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_set_grouper[49m[43m([49m[43mobj[49m[43m)[49m
[1;32m   1591[0m     ax [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39max
[1;32m   1592[0m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(ax, DatetimeIndex):

File [0;32m~/miniconda3/lib/python3.8/site-packages/pandas/core/groupby/grouper.py:400[0m, in [0;36mGrouper._set_grouper[0;34m(self, obj, sort)[0m
[1;32m    398[0m         [38;5;28;01melse[39;00m:
[1;32m    399[0m             [38;5;28;01mif[39;00m level [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m ([38;5;241m0[39m, ax[38;5;241m.[39mname):
[0;32m--> 400[0m                 [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mThe level [39m[38;5;132;01m{[39;00mlevel[38;5;132;01m}[39;00m[38;5;124m is not valid[39m[38;5;124m"[39m)
[1;32m    402[0m [38;5;66;03m# possibly sort[39;00m
[1;32m    403[0m [38;5;28;01mif[39;00m ([38;5;28mself[39m[38;5;241m.[39msort [38;5;129;01mor[39;00m sort) [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m ax[38;5;241m.[39mis_monotonic:
[1;32m    404[0m     [38;5;66;03m# use stable sort to support first, last, nth[39;00m
[1;32m    405[0m     [38;5;66;03m# TODO: why does putting na_position="first" fix datetimelike cases?[39;00m

[0;31mValueError[0m: The level -1 is not valid
ValueError: The level -1 is not valid

